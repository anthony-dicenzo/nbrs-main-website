# Ralph Progress Log
Started: 2026-01-31

## Codebase Patterns

### Svelte 5 Runes
- Use `let x = $state(0)` for reactive state, not `let x = 0`
- Use `$effect(() => { ... })` for side effects, not `$: { ... }`
- Props: `let { prop } = $props()` not `export let prop`

### GSAP Integration
- MUST dynamically import in onMount to avoid SSR errors
- Example: `const gsap = (await import('gsap')).default`
- Use GSAP context for cleanup: `ctx = gsap.context(() => { ... })`
- Call `ctx.revert()` in onDestroy to prevent memory leaks

### Tailwind v4
- Config is in `src/app.css` using `@theme` block, NOT tailwind.config.js
- Brand colors: `--color-nbrs-green: #4fa64f`
- Use classes like `bg-nbrs-green`, `text-nbrs-green`
- Custom breakpoint: `--breakpoint-xs: 375px` for extra small screens

### Mobile Responsive Pattern (from PHASE7-03)
- Use `xs:` prefix for 375px+ breakpoint (iPhone SE and larger)
- Typography scale: `text-3xl xs:text-4xl sm:text-5xl md:text-6xl lg:text-7xl`
- Container padding: `px-4 sm:px-6` for mobile-first spacing
- Touch targets: `min-h-[44px]` or `min-h-[48px]` for buttons and links
- Buttons: Stack vertically on mobile with `flex-col xs:flex-row`
- Hide secondary nav items on small screens: `hidden xs:inline-flex`
- Forms: Already responsive with `sm:grid-cols-2` pattern

### Page Transitions
- Use Svelte `#key` block with `data.pathname` in +layout.svelte
- `+layout.ts` provides pathname via load function
- Nav and Footer stay OUTSIDE #key block (persist during transitions)

### Component Patterns
- Rollover.svelte: Text slide animation, requires parent `group` class
- Logo.svelte: variant prop for 'color' or 'white'
- SocialIcons.svelte: LinkedIn, X, Instagram links

### Build Requirements
- `npm run build` MUST pass (adapter-static for Cloudflare Pages)
- All routes must exist or build fails
- Videos should be < 5MB, WebM primary, MP4 fallback

### Reference Sites
- Design reference: https://www.americanhousing.co/
- Brand assets: https://nbrs.ca (videos on Cloudinary)

### GSAP Utility Pattern (from PHASE3-01)
- Use `useGsap` action from `$lib/utils/gsap` for GSAP animations
- Action signature: `use:useGsap={(gsap, el) => { ... }}`
- Returns from callback for cleanup: `return gsap.timeline()` or `return tween`
- Use `prefersReducedMotion()` helper for accessibility
- For complex scenarios (ScrollTrigger), use `createGsapContext()` in onMount

### VideoHero Pattern (from PHASE4-01)
- Use `children` prop with `Snippet` type instead of deprecated `<slot>`
- Cloudinary auto-generates poster: replace `.mp4` with `.jpg` in URL
- Cloudinary auto-generates WebM: replace `.mp4` with `.webm` in URL
- Video rotation: Use `#key currentIndex` to properly unmount/remount video element
- Always include `playsinline` attribute for iOS autoplay support

### Mobile Detection Pattern (from PHASE4-03)
- File MUST be `.svelte.ts` (not `.ts`) to use Svelte 5 runes
- Import from `$lib/utils/mobile.svelte` (without .ts extension)
- Call `initMobileDetection()` in onMount
- Use `$derived(!isMobile())` for reactive video visibility
- MOBILE_BREAKPOINT = 768px matches Tailwind `md:` breakpoint

### HubSpot Integration Pattern (from PHASE6-03)
- Import `submitPartnerForm`, `submitWaitlistForm` from `$lib/utils/hubspot`
- Validation: `validatePartnerForm(data)` returns `ValidationErrors` object (empty = valid)
- Submit: `await submitPartnerForm(data)` returns `{ success, errors?, message? }`
- Environment: `PUBLIC_HUBSPOT_PORTAL_ID`, `PUBLIC_HUBSPOT_PARTNER_FORM_ID`, `PUBLIC_HUBSPOT_WAITLIST_FORM_ID`
- Demo mode: Works without HubSpot config (simulates success after 800ms)
- Error styling: `border-red-500 focus:border-red-500 focus:shadow-[0_0_0_3px_rgba(239,68,68,0.15)]`

### Core Web Vitals Pattern (from PHASE7-01)
- Use `@font-face` with `font-display: swap` (not `@import url()`)
- Add `rel="preconnect"` in app.html for external domains (Cloudinary, fonts)
- Use `fetchpriority="high"` on LCP images (hero poster)
- Always add `width` and `height` attributes to images to prevent CLS
- Preload LCP image in `<svelte:head>` with `<link rel="preload" as="image">`
- Use `decoding="async"` on images for non-blocking decode
- Vite: `cssMinify: 'lightningcss'` for smaller, faster CSS

### Accessibility Pattern (from PHASE7-02)
- Section landmarks: `<section aria-labelledby="heading-id">` or `<section aria-label="Label">`
- Decorative elements: Add `aria-hidden="true"` to SVG icons, backgrounds, badges
- Forms: Add `<label>` for all inputs, use `sr-only` class for hidden labels
- Success states: Add `role="status" aria-live="polite"` for dynamic announcements
- Semantic structure: Use `<header>`, `<main>`, `<footer>`, `<nav>` appropriately
- Page metadata: Every page needs `<svelte:head>` with unique `<title>` and `<meta name="description">`
- Nav SVG arrows in buttons: Add `aria-hidden="true"` since text label exists

### SVG Line Drawing Animation (from PHASE8-01)
- Get path length: `const length = svgPath.getTotalLength()`
- Set initial state: `gsap.set(path, { strokeDasharray: length, strokeDashoffset: length })`
- Animate: `gsap.to(path, { strokeDashoffset: 0, duration: 1.5 })`
- Works with `<path>` elements only, use opacity animation for `<rect>` and `<circle>`
- Blueprint style: Use `stroke="#4fa64f"` with `fill="none"` for line drawings
- Warm background: `bg-amber-50` provides cream/beige tone

---

## 2026-01-31 - PHASE3-01: GSAP Context Pattern and Reusable Actions

### What was implemented
- Created `src/lib/utils/gsap.ts` with:
  - `useGsap` Svelte action for GSAP animations with automatic context cleanup
  - `loadGsap()` and `loadScrollTrigger()` for dynamic SSR-safe imports
  - `prefersReducedMotion()` helper for accessibility
  - `createGsapContext()` for complex manual usage with onMount/onDestroy
- Updated `src/lib/actions/animate.ts` to use dynamic imports via `loadGsap()`
- Updated homepage to demonstrate `useGsap` action with prefers-reduced-motion

### Files changed
- src/lib/utils/gsap.ts (new)
- src/lib/actions/animate.ts (updated to dynamic imports)
- src/routes/+page.svelte (updated to use useGsap action)

### Learnings for future iterations
- GSAP context `ctx.revert()` cleans up ALL animations in scope automatically
- Dynamic import caches: `gsapInstance` pattern prevents multiple loads
- Action return object `update()` allows reactive params without re-creating context
- The `loadGsap()` helper is synchronous after first load (returns cached instance)

---

## 2026-01-31 - PHASE3-02: Splash Animation Component

### What was implemented
- Created `src/lib/components/Splash.svelte` with:
  - Full GSAP timeline animation matching nbrs.ca style
  - N-B-R-S letters animate in with stagger (scale 0→1.2→1, rotationX: 180→0, y: 100→0)
  - Uses `back.out(1.7)` easing for playful bounce effect
  - White circle expands from center to reveal main content
  - sessionStorage gating: animation only plays once per session
  - prefers-reduced-motion support: brief display then instant hide
- Integrated Splash component into `+layout.svelte`

### Files changed
- src/lib/components/Splash.svelte (new)
- src/routes/+layout.svelte (added Splash import and component)

### Learnings for future iterations
- For complex GSAP timelines with multi-phase animations, use `createGsapContext()` in onMount
- `bind:this` refs work in Svelte 5 without $state() - the warning is informational
- Circle expansion trick: use `w-[150vmax] h-[150vmax]` to ensure circle covers all viewport sizes
- Timeline chaining with negative offsets (`'-=0.1'`) creates smooth overlapping transitions
- Props in Svelte 5: `let { onComplete }: { onComplete?: () => void } = $props()`

---

## 2026-01-31 - Phase 1 & 2 Complete (Manual)

### Phase 1: Foundation & Infrastructure
- SvelteKit + Tailwind v4 + GSAP project setup
- Static adapter for Cloudflare Pages
- Video optimization pipeline (FFmpeg scripts)
- Route structure for all pages

### Phase 2: Layout & Navigation
- Scroll-responsive Nav (hides on scroll down, shows on scroll up)
- Footer with "Neighbourhood Scale" branding, SVG social icons
- Page transitions (150ms fade in/out)
- Mobile responsive (320px+)

### Gap Closure (02-03, 02-04)
- Nav polished: NBRS logo SVG, pill buttons, rollover animations, skip-to-content
- Footer polished: Large brand text, real SVG icons, americanhousing.co layout

**Learnings:**
- White logo on light background is invisible - use green logo when no dark hero
- Always create placeholder routes for nav links or build fails
- Reference quality expectations must be explicit in planning

---

## 2026-01-31 - PHASE4-01: VideoHero Component with Poster Preload

### What was implemented
- Created `src/lib/components/VideoHero.svelte` with:
  - Poster image shows immediately (preloaded via JS Image constructor)
  - Video autoplays muted after poster loads
  - WebM primary, MP4 fallback (Cloudinary URL transformation)
  - Video rotation support for multiple sources (9s interval)
  - Optional overlay class for darkening/gradients
  - Content via `children` Snippet (Svelte 5 pattern)
  - Full viewport height hero sizing
- Updated homepage with VideoHero showing 3 rotating videos from nbrs.ca

### Files changed
- src/lib/components/VideoHero.svelte (new)
- src/routes/+page.svelte (replaced with VideoHero demo)

### Learnings for future iterations
- Svelte 5: Use `import type { Snippet } from 'svelte'` for typed children props
- Svelte 5: `{@render children()}` replaces deprecated `<slot>`
- Cloudinary URL transformations: Just change file extension for format conversion
- Video poster preload: Use `new Image()` to preload, then show video element
- `#key currentIndex` forces video element remount on source change (clean swap)

### VideoSection Pattern (from PHASE4-02)
- Use IntersectionObserver with `rootMargin: '200px'` to start loading before visible
- Stop observing after first intersection (video stays loaded)
- Use `shouldLoad` state to conditionally render `<video>` element (prevents network requests)
- Fade transition: Container has `transition-opacity duration-700`, starts `opacity-0`
- SSR fallback: Check `typeof IntersectionObserver === 'undefined'` and load immediately

---

## 2026-01-31 - PHASE4-02: VideoSection Component with Lazy Loading

### What was implemented
- Created `src/lib/components/VideoSection.svelte` with:
  - IntersectionObserver-based lazy loading
  - Video only loads when in/near viewport (200px rootMargin)
  - Smooth fade transition (700ms) when video becomes visible
  - Poster image shows until video loads
  - Configurable aspect ratio via `aspectRatio` prop
  - Optional overlay class for darkening/gradients
  - Content via `children` Snippet (Svelte 5 pattern)
  - SSR fallback: loads immediately if IntersectionObserver unavailable
- Updated homepage with two VideoSection demos showing lazy-loaded content sections

### Files changed
- src/lib/components/VideoSection.svelte (new)
- src/routes/+page.svelte (added VideoSection imports and demo sections)

### Learnings for future iterations
- IntersectionObserver cleanup: Must call both `unobserve()` and `disconnect()` in onDestroy
- Use `shouldLoad` boolean to conditionally render video element (prevents network requests)
- `requestAnimationFrame` after intersection helps ensure smooth fade-in timing
- Container-level fade (`opacity-0` → `opacity-100`) + video crossfade creates polished effect
- Stop observing after first intersection to prevent re-triggering

---

## 2026-01-31 - PHASE4-03: Mobile Video Fallback

### What was implemented
- Created `src/lib/utils/mobile.svelte.ts` with:
  - `initMobileDetection()` to set up window resize listener
  - `isMobile()` reactive function returning current mobile state
  - `checkIsMobile()` for one-time checks
  - Uses 768px breakpoint (matches Tailwind `md:`)
  - SSR-safe: returns false during server-side rendering
- Updated `src/lib/components/VideoHero.svelte`:
  - Imports and uses `initMobileDetection()` and `isMobile()`
  - Conditionally renders video element only on desktop
  - Poster image stays visible on mobile (no fade out)
  - Video rotation only starts on desktop
- Updated `src/lib/components/VideoSection.svelte`:
  - Same mobile detection integration
  - Video lazy loading only triggers on desktop
  - Poster image remains as static fallback on mobile

### Files changed
- src/lib/utils/mobile.svelte.ts (new)
- src/lib/components/VideoHero.svelte (updated)
- src/lib/components/VideoSection.svelte (updated)

### Learnings for future iterations
- Svelte 5 runes (`$state`, `$derived`) require `.svelte.ts` extension, NOT plain `.ts`
- Mobile detection via screen width is more reliable than user agent sniffing
- Reactive mobile detection allows layout to adapt if window is resized
- Poster images prevent layout shift: same dimensions as video element
- SSR default of `false` for `isMobile()` means videos load on server-side render, then client hydration may hide them on mobile - this is acceptable as the alternative (SSR showing mobile view) would flash on desktop

### Mobile Detection Pattern (from PHASE4-03)
- File must be `.svelte.ts` to use runes
- Call `initMobileDetection()` in onMount of components that need it
- Use `isMobile()` in `$derived` for reactive checks
- MOBILE_BREAKPOINT = 768px matches Tailwind md: breakpoint
- Pattern: `const showVideoOnDevice = $derived(!isMobile())`

### ScrollTrigger Pattern (from PHASE5-01)
- Use `scrollReveal` action from `$lib/utils/gsap` for scroll-triggered animations
- Action signature: `use:scrollReveal={{ type: 'slide-up', duration: 0.8 }}`
- Animation types: 'fade', 'slide-up', 'slide-left', 'slide-right', 'scale'
- Options: duration, delay, distance, start, stagger, staggerSelector
- Automatically respects `prefers-reduced-motion` for accessibility
- Uses GSAP context for proper cleanup on route changes

---

## 2026-02-01 - PHASE5-01: ScrollTrigger Section Reveals

### What was implemented
- Extended `src/lib/utils/gsap.ts` with:
  - `ScrollRevealOptions` interface for configurable scroll animations
  - `scrollReveal` Svelte action using GSAP ScrollTrigger
  - Five animation types: fade, slide-up, slide-left, slide-right, scale
  - Support for staggered children animations
  - Automatic prefers-reduced-motion respect
  - Proper cleanup via GSAP context on destroy
- Updated `src/routes/+page.svelte`:
  - Added scroll reveal to About section (text slides up, video fades in)
  - Added scroll reveal to Mission section (video fades in, text slides up)
  - Added scroll reveal to bottom navigation section

### Files changed
- src/lib/utils/gsap.ts (extended with scrollReveal action)
- src/routes/+page.svelte (added scrollReveal to sections)

### Learnings for future iterations
- ScrollTrigger automatically reverts with GSAP context - no manual cleanup needed
- `toggleActions: 'play none none none'` plays once and doesn't reverse (professional feel)
- `start: 'top 85%'` triggers animation when element is 85% from top of viewport
- Subtle distances (60px slide) and durations (0.8s) feel professional
- Wrapping VideoSection in a div for scrollReveal keeps video component clean
- `power2.out` easing provides natural deceleration for reveal animations

---

## 2026-02-01 - PHASE6-01: Homepage Hero and Sections Structure

### What was implemented
- Completely redesigned `src/routes/+page.svelte` with polished homepage structure:
  - **Hero Section**: Video background with gradient overlay, two-line headline "Building Homes, Building Community", subheadline, and "Sincerely, Your NBRS" tagline. Added scroll indicator with bounce animation.
  - **FAMILY 1 Project Preview**: Left video, right content with section label, large title, description, and two CTAs (Learn More, Join Waitlist). Uses btn classes for polished interactions.
  - **How We Build Section**: Centered intro with three numbered process steps. Large faded numbers (01, 02, 03) create visual hierarchy. Steps stagger on scroll reveal.
  - **About/Mission Section**: Explains NBRS name (Neighbourhood Based Rental Solutions) with bold letter highlighting. Left content, right video.
  - **Partner CTA Section**: Full-width NBRS green section with centered headline and partner CTA button.
- All sections use scroll reveal animations with appropriate timing and delays
- Responsive layout with sm/md/lg breakpoints

### Files changed
- src/routes/+page.svelte (complete rewrite)

### Learnings for future iterations
- Section label pattern: `text-nbrs-green font-semibold text-sm tracking-wider uppercase` creates consistency
- Gradient overlay on hero: `bg-gradient-to-b from-black/40 via-black/20 to-black/50` gives depth
- btn/btn-primary/btn-secondary classes from app.css create consistent button styling
- Staggered scroll reveals: use `delay: i * 0.15` for sequential items
- Large faded numbers (text-nbrs-green/10) create visual interest without competing
- Break headlines at natural points with `<br />` for better typography
- Aspect ratio 4/5 for taller portrait videos in About section
- Partner CTA section doesn't need video - text-only with brand color is effective

---

## 2026-02-01 - PHASE6-02: Partner and Waitlist Pages

### What was implemented
- **Partner page** (`src/routes/partner/+page.svelte`):
  - Hero with green background and decorative circles
  - "Why Partner With Us" section with 3 benefit cards (Stable Returns, Community Impact, Scalable Model)
  - "Who We Work With" section with numbered partner types (Investors, Nonprofits, Landowners, Municipalities)
  - Contact form with fields: name, email, organization, partner type, message
  - Form has loading state, success state, and error handling
  - Direct email CTA at bottom

- **Waitlist page** (`src/routes/waitlist/+page.svelte`):
  - Dark hero with "Coming 2026" badge and FAMILY 1 branding
  - Feature strip showing unit highlights (3 Bedrooms, Storage Space, Outdoor Access, Vibrant Area)
  - "What to Expect" info card with waitlist benefits
  - Signup form with fields: first name, last name, email, phone, household size, neighbourhood, unit type
  - Toronto neighbourhood options (Downtown, East York, Scarborough, North York, Etobicoke, Other GTA)
  - Form validation, loading state, success state with CTA to FAMILY 1 page
  - Learn More CTA section at bottom

### Files changed
- src/routes/partner/+page.svelte (complete rewrite)
- src/routes/waitlist/+page.svelte (complete rewrite)

### Learnings for future iterations
- Svelte 5 form pattern: Use `$state()` for formData object, `onsubmit={handleSubmit}` not `on:submit`
- Use `$state<'idle' | 'success' | 'error'>('idle')` for typed submission status
- `.form-input` class from app.css provides consistent input styling with focus states
- Decorative background circles: `opacity-10` or `opacity-20` for subtle visual interest
- Partner types work well as numbered list with circular badges (1, 2, 3, 4)
- Feature strips: `grid-cols-2 md:grid-cols-4` for responsive icon/text pairs
- Blur effect for hero backgrounds: `blur-3xl` on colored circles creates ambient glow
- Privacy note at form bottom: `text-xs text-gray-500 text-center` for unobtrusive legal text

---

## 2026-02-01 - PHASE6-03: HubSpot Form Integration

### What was implemented
- **HubSpot utility** (`src/lib/utils/hubspot.ts`):
  - HubSpot Forms API v3 integration using unauthenticated endpoint
  - `submitPartnerForm()` and `submitWaitlistForm()` functions
  - `validatePartnerForm()` and `validateWaitlistForm()` with detailed error messages
  - TypeScript interfaces for form data and validation errors
  - Demo mode fallback when HubSpot not configured (simulates success)
  - `hutk` cookie retrieval for visitor tracking association
  - Proper error handling with user-friendly messages

- **Partner form updates** (`src/routes/partner/+page.svelte`):
  - Integrated with HubSpot submission
  - Field-level validation errors with red border styling
  - ARIA attributes for accessibility (aria-invalid, aria-describedby)
  - Loading spinner animation during submission
  - General error state for network/API failures
  - Clear field errors on input (oninput/onchange handlers)

- **Waitlist form updates** (`src/routes/waitlist/+page.svelte`):
  - Same HubSpot integration and validation patterns
  - All 7 fields have proper error handling
  - Phone validation for 10+ digit numbers

- **Environment setup**:
  - Created `.env.example` documenting required variables:
    - `PUBLIC_HUBSPOT_PORTAL_ID`
    - `PUBLIC_HUBSPOT_PARTNER_FORM_ID`
    - `PUBLIC_HUBSPOT_WAITLIST_FORM_ID`

### Files changed
- src/lib/utils/hubspot.ts (new - 230+ lines)
- src/routes/partner/+page.svelte (updated form handling)
- src/routes/waitlist/+page.svelte (updated form handling)
- .env.example (new)

### Learnings for future iterations
- HubSpot Forms API v3 endpoint: `https://api.hsforms.com/submissions/v3/integration/submit/:portalId/:formGuid`
- Field names in `fields` array must match HubSpot property internal names exactly
- `hutk` cookie enables visitor tracking association - check for `hubspotutk` cookie
- Use `import.meta.env.PUBLIC_*` for client-exposed environment variables in SvelteKit
- Demo mode fallback allows development without HubSpot configuration
- Field-level error styling: `border-red-500 focus:border-red-500 focus:shadow-[0_0_0_3px_rgba(239,68,68,0.15)]`
- Clear errors on input to provide immediate feedback when user corrects mistakes
- Loading spinner with SVG animation looks more polished than text-only "Loading..."

### HubSpot Integration Pattern (for Codebase Patterns section)
- Import from `$lib/utils/hubspot` for form submission utilities
- Validation functions return `ValidationErrors` object (empty = valid)
- Submit functions return `SubmissionResult` with `success`, `errors?`, `message?`
- Forms need: `fieldErrors: ValidationErrors`, `generalError: string`, `clearFieldError()` function

---

## 2026-02-01 - PHASE7-01: Core Web Vitals Optimization

### What was implemented
- **Font loading optimization** (`src/app.css`):
  - Replaced blocking `@import url()` with direct `@font-face` declarations
  - Added `font-display: swap` to prevent render blocking
  - Uses Inter Variable font (woff2) for optimal compression

- **Resource preconnect** (`src/app.html`):
  - Added `preconnect` and `dns-prefetch` for Cloudinary (video/images)
  - Added `preconnect` and `dns-prefetch` for rsms.me (fonts)

- **LCP image optimization**:
  - Added `<link rel="preload">` for hero poster in `svelte:head`
  - Added `fetchpriority="high"` to hero poster image
  - Added explicit `width` and `height` attributes (1920x1080)
  - Added `decoding="async"` for non-blocking decode

- **CLS prevention**:
  - Added explicit dimensions to all video poster images
  - Container already uses `h-screen` or `aspect-ratio` for stability

- **Build optimization** (`vite.config.ts`):
  - Enabled `lightningcss` for CSS minification
  - Enabled `cssCodeSplit` for better caching
  - Increased `assetsInlineLimit` to 4096 bytes
  - Configured output filenames for cache optimization

### Files changed
- src/app.css (font-face with font-display: swap)
- src/app.html (preconnect hints)
- src/lib/components/VideoHero.svelte (fetchpriority, dimensions)
- src/lib/components/VideoSection.svelte (dimensions, decoding)
- src/routes/+page.svelte (LCP preload in svelte:head, meta tags)
- vite.config.ts (build optimizations)

### Learnings for future iterations
- `font-display: swap` shows fallback font immediately, swaps when custom font loads
- `fetchpriority="high"` tells browser to prioritize LCP image over other resources
- Explicit `width`/`height` on images prevents CLS by reserving space
- `decoding="async"` allows main thread to continue while image decodes
- Vite's `lightningcss` minifier is faster and produces smaller output than default
- SvelteKit overrides some rollup output options (entryFileNames, etc.) - warnings are normal

### Core Web Vitals Pattern (for Codebase Patterns section)
- Use `@font-face` with `font-display: swap` instead of `@import url()`
- Add `rel="preconnect"` for external domains (CDNs, fonts)
- Use `fetchpriority="high"` on LCP images
- Always add `width` and `height` to images to prevent CLS
- Preload LCP resources in `<svelte:head>` with `rel="preload"`

---

## 2026-02-01 - PHASE7-02: Accessibility Audit and Fixes

### What was implemented
- **Homepage accessibility** (`src/routes/+page.svelte`):
  - Added section landmarks with `aria-label` or `aria-labelledby`
  - Added `id` attributes to h2 headings for section labels
  - Added `aria-hidden="true"` to decorative SVGs (scroll indicator, arrow icons)
  - Added `aria-hidden="true"` to decorative step numbers in How We Build section

- **Footer accessibility** (`src/lib/components/Footer.svelte`):
  - Changed decorative h2 "Neighbourhood Scale" to `<p>` with `aria-hidden="true"`
  - Added `<label>` with `sr-only` class for email inputs
  - Added `id` attributes for label/input association
  - Added `autocomplete="email"` for improved UX
  - Added `aria-label="Newsletter signup"` to forms

- **Nav accessibility** (`src/lib/components/Nav.svelte`):
  - Changed container from `<div>` to `<header>` for semantic structure
  - Added `aria-hidden="true"` to decorative arrow SVG
  - Added `aria-hidden="true"` to background fade element

- **Partner page** (`src/routes/partner/+page.svelte`):
  - Added section landmarks with proper headings
  - Added `aria-hidden="true"` to decorative background circles
  - Added `aria-hidden="true"` to benefit icon containers
  - Added `aria-hidden="true"` to numbered partner badges
  - Added `role="status"` and `aria-live="polite"` to success state
  - Added `aria-hidden="true"` to loading spinner SVG

- **Waitlist page** (`src/routes/waitlist/+page.svelte`):
  - Added section landmarks with proper headings
  - Added `aria-hidden="true"` to decorative background gradients
  - Added `aria-hidden="true"` to feature icon containers
  - Added `aria-hidden="true"` to checklist SVGs
  - Added `role="status"` and `aria-live="polite"` to success state
  - Added `aria-hidden="true"` to loading spinner and CTA arrow SVGs

- **Placeholder pages** (mission, family-1, faqs, contact):
  - Added `<svelte:head>` with title and meta description
  - Changed container from `<div>` to `<main>`
  - Added `aria-label="Page navigation"` to nav elements

### Files changed
- src/routes/+page.svelte
- src/lib/components/Footer.svelte
- src/lib/components/Nav.svelte
- src/routes/partner/+page.svelte
- src/routes/waitlist/+page.svelte
- src/routes/mission/+page.svelte
- src/routes/family-1/+page.svelte
- src/routes/faqs/+page.svelte
- src/routes/contact/+page.svelte

### Learnings for future iterations
- Use `<section aria-labelledby="id">` + `<h2 id="id">` for sections with headings
- Use `<section aria-label="Description">` for sections without visible headings
- Decorative SVGs should always have `aria-hidden="true"`
- Form success states should have `role="status"` and `aria-live="polite"` for screen readers
- Use `<header>` instead of `<div>` for site header (has implicit role="banner")
- Email inputs should have `autocomplete="email"` for better autofill
- Decorative text (like large branding) should be `<p aria-hidden="true">` not `<h2>`
- Every page needs `<svelte:head>` with unique title and description

### Accessibility Pattern (for Codebase Patterns section)
- Section landmarks: `<section aria-labelledby="heading-id">` or `<section aria-label="Label">`
- Decorative elements: Add `aria-hidden="true"` to SVG icons, backgrounds, badges
- Forms: Add `<label>` for all inputs, use `sr-only` class for hidden labels
- Success states: Add `role="status" aria-live="polite"` for dynamic announcements
- Semantic structure: Use `<header>`, `<main>`, `<footer>`, `<nav>` appropriately
- Page metadata: Every page needs `<svelte:head>` with unique `<title>` and `<meta name="description">`

---

## 2026-02-01 - PHASE7-03: Mobile Responsive Polish

### What was implemented
- **Custom xs breakpoint** (`src/app.css`):
  - Added `--breakpoint-xs: 375px` for extra small screens (iPhone SE and larger)
  - Enables `xs:` utility classes for fine-grained responsive control

- **Nav mobile fixes** (`src/lib/components/Nav.svelte`):
  - Reduced gap between nav items on small screens (`gap-2 sm:gap-3`)
  - Hide "Mission" button on screens < 375px to prevent overflow
  - Added `min-h-[44px]` to nav pills for touch target accessibility

- **Homepage responsive polish** (`src/routes/+page.svelte`):
  - Hero text scales from `text-3xl` to `text-7xl` across breakpoints
  - Reduced section padding on mobile (`py-16 sm:py-20 md:py-32`)
  - Buttons stack vertically on mobile, horizontal on xs+ (`flex-col xs:flex-row`)
  - All buttons have `min-h-[48px]` for adequate touch targets
  - How We Build section uses 2-column grid on small screens

- **Partner page** (`src/routes/partner/+page.svelte`):
  - Hero text and decorative circles scale appropriately
  - Benefit cards smaller padding on mobile (`p-6 sm:p-8`)
  - Partner list items with smaller badges on mobile (`w-10 sm:w-12`)
  - Form container with reduced padding on mobile

- **Waitlist page** (`src/routes/waitlist/+page.svelte`):
  - Hero with smaller typography on mobile
  - Feature icons smaller on mobile (`w-12 sm:w-14`)
  - Expectations list with smaller checkmarks and gaps
  - Form with 48px minimum touch targets

- **Footer** (`src/lib/components/Footer.svelte`):
  - Reduced minimum height on mobile (320px vs 400px)
  - Brand text smaller on mobile (`text-3xl xs:text-4xl`)
  - Nav links horizontal on all screen sizes with 44px touch targets
  - Form inputs and buttons with 44px minimum height

- **Placeholder pages** (mission, family-1, faqs, contact):
  - Replaced fixed `p-8` with responsive `px-4 py-16 sm:px-6 sm:py-20`
  - Added max-width container for content centering
  - Smaller headings on mobile (`text-2xl xs:text-3xl sm:text-4xl`)
  - Nav links with 44px minimum touch targets

### Files changed
- src/app.css (added xs breakpoint)
- src/lib/components/Nav.svelte (mobile gap, hidden Mission, touch targets)
- src/lib/components/Footer.svelte (smaller mobile, horizontal nav, touch targets)
- src/routes/+page.svelte (responsive typography, buttons, padding)
- src/routes/partner/+page.svelte (responsive hero, cards, badges, form)
- src/routes/waitlist/+page.svelte (responsive hero, features, form)
- src/routes/mission/+page.svelte (responsive padding, typography)
- src/routes/family-1/+page.svelte (responsive padding, typography)
- src/routes/faqs/+page.svelte (responsive padding, typography)
- src/routes/contact/+page.svelte (responsive padding, typography)

### Learnings for future iterations
- Custom breakpoints in Tailwind v4: Add to `@theme { --breakpoint-xs: 375px }`
- Touch targets: Use `min-h-[44px]` for links, `min-h-[48px]` for primary buttons
- Button stacking: `flex-col xs:flex-row` ensures buttons stack on tiny screens
- Typography scale: Always include smallest size for 320px (`text-2xl` or `text-3xl`)
- Container padding: `px-4 sm:px-6` prevents content touching screen edges
- Nav overflow prevention: Hide secondary items with `hidden xs:inline-flex`
- Form already responsive: `sm:grid-cols-2` pattern works well for name fields

---

## 2026-02-01 - PHASE8-01: Illustrated Build Timeline Section

### What was implemented
- **BuildTimeline.svelte component** (`src/lib/components/BuildTimeline.svelte`):
  - Three-step visual process: Find Land, Build Together, Welcome Home
  - Custom SVG illustrations in blueprint/architectural line style:
    - Step 1: Empty lot with dashed property lines, corner markers, measurement lines, tree
    - Step 2: Building under construction with crane, floor lines, windows
    - Step 3: Completed building with roof, windows, door, welcome path, family figures
  - GSAP scroll-triggered line drawing animation using `strokeDasharray`/`strokeDashoffset`
  - Fill elements (circles, rectangles) fade in with delay after paths draw
  - Step cards animate in with stagger
  - Cream/beige background (`bg-amber-50`) matching americanhousing.co
  - Bold numbered headings: "1 Find Land", "2 Build Together", "3 Welcome Home"
  - Responsive layout: stacked on mobile, horizontal 3-column grid on desktop
  - Proper cleanup with GSAP context and `onDestroy`

- **Homepage integration** (`src/routes/+page.svelte`):
  - Replaced plain text "How We Build" section with `<BuildTimeline />` component
  - Removed unused `buildSteps` array

### Files changed
- src/lib/components/BuildTimeline.svelte (new - 300+ lines)
- src/routes/+page.svelte (updated imports, replaced section)

### Learnings for future iterations
- SVG line drawing animation: Use `getTotalLength()` to get path length, then animate `strokeDashoffset` from length to 0
- For SVG rects, use `fill="none"` with stroke for outline-only blueprint style
- `bg-amber-50` provides a warm cream/beige background tone
- Connecting lines between steps on desktop only: `hidden md:block`
- Ensure GSAP context includes all animations (paths, fills, cards, connectors) for proper cleanup
- Use `.closest('.step-card')` to find parent trigger for each SVG element's ScrollTrigger

### SVG Line Drawing Pattern (for Codebase Patterns section)
- Get path length: `const length = svgPath.getTotalLength()`
- Set initial state: `gsap.set(path, { strokeDasharray: length, strokeDashoffset: length })`
- Animate: `gsap.to(path, { strokeDashoffset: 0, duration: 1.5 })`
- Works with `<path>` elements, not `<rect>` or `<circle>` (use opacity for those)

---

## 2026-02-01 - PHASE9-01: Hero Video - Community Oriented

### What was implemented
- **Already complete**: The hero video was already updated to use community-street-festival
- Verified `src/routes/+page.svelte` has:
  - `heroVideo` pointing to `/videos/new/community-street-festival.mp4/.webm/.jpg`
  - LCP preload for community-street-festival.jpg poster
- All web-converted files exist in `static/videos/new/`:
  - community-street-festival.mp4 (15MB)
  - community-street-festival.webm (22MB)
  - community-street-festival.jpg (413KB)
- Build passes

### Files changed
- No changes needed (already implemented)
- scripts/ralph/prd.json (marked passes: true)

### Learnings for future iterations
- Always check if work was already done in a previous session
- Video conversion from MOV to web formats already established pattern

---
