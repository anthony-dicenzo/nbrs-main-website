---
phase: 02-layout-navigation
plan: 02
type: execute
wave: 2
depends_on: ["02-01"]
files_modified:
  - src/routes/+layout.svelte
  - src/routes/+layout.ts
  - src/lib/components/Nav.svelte
  - src/lib/components/Footer.svelte
autonomous: true

must_haves:
  truths:
    - "Page content fades during route navigation (150ms transition)"
    - "Mobile viewports (320px-428px) display nav and footer correctly"
    - "No layout shifts when navigating between pages"
  artifacts:
    - path: "src/routes/+layout.ts"
      provides: "Pathname for page transition key"
      contains: "url.pathname"
    - path: "src/routes/+layout.svelte"
      provides: "Page fade transition using #key block"
      contains: "#key data.pathname"
  key_links:
    - from: "src/routes/+layout.svelte"
      to: "src/routes/+layout.ts"
      via: "load function providing pathname"
      pattern: "data.pathname"
---

<objective>
Add page transitions between routes and ensure responsive behavior on mobile viewports. Polish the layout for production-ready navigation experience.

Purpose: Create smooth, professional navigation experience with subtle fade transitions between pages and proper responsive behavior on all screen sizes.

Output: Page transitions via #key block, responsive refinements to Nav and Footer, +layout.ts for pathname data
</objective>

<execution_context>
@/Users/adicenzo/.claude/get-shit-done/workflows/execute-plan.md
@/Users/adicenzo/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-layout-navigation/02-CONTEXT.md
@.planning/phases/02-layout-navigation/02-RESEARCH.md
@.planning/phases/02-layout-navigation/02-01-SUMMARY.md
@src/routes/+layout.svelte
@src/lib/components/Nav.svelte
@src/lib/components/Footer.svelte
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add page transitions with pathname-keyed fade</name>
  <files>src/routes/+layout.ts, src/routes/+layout.svelte</files>
  <action>
Create +layout.ts to provide pathname for transition keying:

```typescript
// src/routes/+layout.ts
export const load = ({ url }) => {
  return { pathname: url.pathname };
};
```

Update +layout.svelte to add fade transitions:

1. Import fade from svelte/transition:
   `import { fade } from 'svelte/transition';`

2. Update props to receive data:
   `let { children, data } = $props();`

3. Wrap main content in #key block with fade:
```svelte
{#key data.pathname}
  <main
    class="min-h-screen pt-16"
    in:fade={{ duration: 150, delay: 150 }}
    out:fade={{ duration: 150 }}
  >
    {@render children()}
  </main>
{/key}
```

The delay on `in` ensures old page fades out before new page fades in (no overlap).

Note: Keep Nav and Footer OUTSIDE the #key block - they should persist, not transition.
  </action>
  <verify>
1. `npm run dev`
2. Click between nav links (Home, Partner, etc.)
3. Content should fade out (150ms), then fade in (150ms) - total 300ms transition
4. Nav and Footer should NOT animate during transition
  </verify>
  <done>Navigating between pages shows smooth 150ms fade out, 150ms fade in transition</done>
</task>

<task type="auto">
  <name>Task 2: Polish responsive layout for mobile viewports</name>
  <files>src/lib/components/Nav.svelte, src/lib/components/Footer.svelte</files>
  <action>
Ensure Nav and Footer work correctly on mobile viewports (320px to 428px).

Per CONTEXT.md: No hamburger menu needed - only two links that fit at all sizes.

Nav refinements:
- Ensure logo and links don't wrap awkwardly on small screens
- Consider reducing gap between links on mobile: `gap-4 md:gap-8`
- Consider smaller text on mobile if needed: `text-lg md:text-xl`
- Ensure padding works on small screens: `px-4 md:px-6`

Footer refinements:
- Stack bottom section vertically on mobile:
  - Social icons and nav+signup should stack: `flex-col md:flex-row`
- Reduce heading size on mobile: `text-3xl md:text-4xl lg:text-6xl`
- Ensure form input and button don't overflow:
  - Consider: `flex flex-col sm:flex-row` for the form
  - Input: `w-full sm:w-auto`
- Ensure adequate padding: `px-4 md:px-6`

Test at these breakpoints:
- 320px (iPhone SE)
- 375px (iPhone 12 mini)
- 390px (iPhone 14)
- 428px (iPhone 14 Pro Max)
  </action>
  <verify>
1. Open DevTools, enable responsive mode
2. Test at 320px, 375px, 390px, 428px widths
3. Nav: Logo and links visible, no overflow, no wrapping
4. Footer: Content readable, form usable, no horizontal scroll
  </verify>
  <done>Nav and Footer display correctly without overflow on viewports from 320px to 428px</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete layout system with scroll-responsive navigation, branded footer, page transitions, and mobile responsiveness</what-built>
  <how-to-verify>
1. Visit http://localhost:5173 in your browser
2. Verify navigation:
   - Nav visible at top with "NBRS" or "Neighbourhood Scale" logo and Mission/Partner links
   - Scroll down - nav should hide smoothly
   - Scroll up - nav should reappear with green background
3. Verify footer:
   - Scroll to bottom - green footer with large "Neighbourhood Scale" text
   - Social icons (or placeholders) visible
   - Email signup form visible
4. Verify page transitions:
   - Click between routes (Home, Partner, Waitlist, FAMILY 1)
   - Content should fade smoothly (no jarring cuts)
   - Nav and Footer should NOT animate
5. Verify mobile responsiveness:
   - Open DevTools (F12) -> Toggle device toolbar (Ctrl+Shift+M)
   - Set width to 320px
   - Verify nav links don't wrap or overflow
   - Verify footer is readable and form is usable
6. Verify build:
   - Run `npm run build` in terminal
   - Should complete without errors
  </how-to-verify>
  <resume-signal>Type "approved" if layout looks good, or describe any issues</resume-signal>
</task>

</tasks>

<verification>
After all tasks complete and checkpoint approved:
1. `npm run dev` serves site without console errors
2. `npm run build` produces static output successfully
3. All routes show consistent Nav and Footer
4. Page transitions work smoothly
5. Mobile viewports display correctly (320px minimum)
</verification>

<success_criteria>
- Page transitions: 150ms fade out, 150ms fade in on route change
- Nav/Footer persist during page transitions (don't re-animate)
- Mobile viewports (320px+) show nav and footer without overflow
- No horizontal scrollbar on any viewport
- Build completes successfully
</success_criteria>

<output>
After completion, create `.planning/phases/02-layout-navigation/02-02-SUMMARY.md`
</output>
