<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NBRS</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio,line-clamp"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <!-- Add Lucide Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lucide-static@0.16.29/font/lucide.min.css">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <script>
        window.addEventListener('error', function(e) {
            if (e.target.src && e.target.src.includes('hubspot')) {
                console.warn('HubSpot resource blocked:', e.target.src);
                // Continue without HubSpot
                return true;
            }
        }, true);
    </script>
    <style>
        .bg-pattern {
            background-image: url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 80 80" width="80" height="80"><path fill="%23ffffff" fill-opacity="0.4" d="M14 16H9v-2h5V9.87a4 4 0 1 1 2 0V14h5v2h-5v15.95A10 10 0 0 0 23.66 27l-3.46-2 8.2-2.2-2.9 5a12 12 0 0 1-21 0l-2.89-5 8.2 2.2-3.47 2A10 10 0 0 0 14 31.95V16zm40 40h-5v-2h5v-4.13a4 4 0 1 1 2 0V54h5v2h-5v15.95A10 10 0 0 0 63.66 67l-3.47-2 8.2-2.2-2.88 5a12 12 0 0 1-21.02 0l-2.88-5 8.2 2.2-3.47 2A10 10 0 0 0 54 71.95V56zm-39 6a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm40-40a2 2 0 1 1 0-4 2 2 0 0 1 0 4zM15 8a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm40 40a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"></path></svg>');
        }
        
        .intro-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: #4fa64f;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        
        .intro-text {
            font-size: clamp(2rem, 15vw, 8rem);
            font-weight: 900;
            color: white;
            position: absolute;
            z-index: 1001;
        }
        
        .letter {
            display: inline-block;
            opacity: 0;
        }

        .white-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 0;
            height: 0;
            background: white;
            border-radius: 50%;
            z-index: 1000;
        }

        .slide-content {
            opacity: 0;
            transform: translateY(-100px);
        }

        #app {
            visibility: hidden;
        }
        
        .buildings-container {
            position: relative;
            margin-bottom: -2rem;
            overflow: hidden;
        }
        
        .buildings-wrapper {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            gap: 0.5rem;
            padding: 0 1rem;
        }
        
    
        .building {
        opacity: 0;
            transform-origin: bottom;
        }

        .cityscape-section {
            background-color: #4fa64f;
            padding: 4rem 0 0;
            position: relative;
            z-index: 1;
            margin-bottom: -2rem;
            overflow: hidden;
        }

        .building {
            opacity: 0;
            transform-origin: bottom;
            filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.1));
        }

        #cityscape {
            display: block;
            margin-bottom: -2px;
        }

        .cloud {
            opacity: 0.6;
            fill: white;
            filter: url(#cloudFilter);
        }

        @media (max-width: 768px) {
            .cloud {
                opacity: 0.8;
            }
            .cloud1 {
                transform: scale(0.8);
            }
            .cloud2 {
                transform: scale(0.7);
            }
            .cloud3 {
                transform: scale(0.9);
            }
        }

        .bird {
            fill: none;
            stroke: rgba(255, 255, 255, 0.6);
            stroke-width: 2;
        }

        .hero-section {
            position: relative;
            overflow: hidden;
        }

        .hero-video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: 0;
            transition: opacity 1s ease-in-out;
        }

        @media (max-width: 768px) {
            .hero-video {
                display: none;
            }
            .hero-section {
                background-color: #4fa64f;
            }
        }

        .hero-content {
            position: relative;
            z-index: 1;
        }

        .hero-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: transparent;
            z-index: 1;
        }

        .fade-enter-active, .fade-leave-active {
            transition: opacity 0.2s;
        }
        .fade-enter-from, .fade-leave-to {
            opacity: 0;
        }
        .fade-enter-to, .fade-leave-from {
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="intro-overlay">
        <div class="intro-text">
            <span class="letter">N</span>
            <span class="letter">B</span>
            <span class="letter">R</span>
            <span class="letter">S</span>
        </div>
        <div class="white-overlay"></div>
    </div>
    <div id="app" class="min-h-screen bg-[#4fa64f] bg-opacity-90">
        <!-- Header -->
        <header class="px-4 lg:px-6 h-16 flex items-center bg-[#4fa64f] shadow-md fixed w-full z-50">
            <div class="container mx-auto flex items-center justify-between">
                <a class="flex items-center justify-center" href="#">
                    <i class="lucide-building-2 h-6 w-6 mr-2 text-white"></i>
                    <span class="font-bold text-lg text-white">NBRS</span>
                </a>
                <!-- Mobile Accordion Nav -->
                <div class="md:hidden flex items-center">
                    <button @click="menuOpen = !menuOpen" class="text-white focus:outline-none">
                        <span v-if="!menuOpen">
                            <!-- Hamburger SVG -->
                            <svg class="h-7 w-7" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round">
                                <line x1="4" y1="6" x2="20" y2="6" />
                                <line x1="4" y1="12" x2="20" y2="12" />
                                <line x1="4" y1="18" x2="20" y2="18" />
                            </svg>
                        </span>
                        <span v-else>
                            <!-- Close (X) SVG -->
                            <svg class="h-7 w-7" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round">
                                <line x1="18" y1="6" x2="6" y2="18" />
                                <line x1="6" y1="6" x2="18" y2="18" />
                            </svg>
                        </span>
                    </button>
                    <transition name="fade">
                        <div v-if="menuOpen" class="absolute top-16 right-4 w-48 bg-white rounded-xl shadow-lg z-50 border border-gray-200">
                            <ul class="flex flex-col divide-y divide-gray-200">
                                <li>
                                    <a href="#about" class="block px-6 py-4 text-[#4fa64f] font-semibold hover:bg-gray-50" @click="menuOpen = false">About Us</a>
                                </li>
                                <li>
                                    <a href="#partner" class="block px-6 py-4 text-[#4fa64f] font-semibold hover:bg-gray-50" @click="menuOpen = false">Partner With Us</a>
                                </li>
                            </ul>
                        </div>
                    </transition>
                </div>
                <!-- Desktop Nav -->
                <nav class="hidden md:block">
                    <ul class="flex flex-row items-center space-x-8">
                        <li><a class="text-sm font-medium hover:underline underline-offset-4 text-white" href="#about">About Us</a></li>
                        <li><a class="text-sm font-medium hover:underline underline-offset-4 text-white font-bold" href="#partner">Partner With Us</a></li>
                    </ul>
                </nav>
            </div>
        </header>

        <!-- Main Content -->
        <main class="pt-16">
            <!-- Hero Section -->
            <section class="hero-section w-full py-20 md:py-32 lg:py-48 relative overflow-hidden bg-[#4fa64f]">
                <!-- Responsive Video Background (hidden on mobile) -->
                <div class="absolute inset-0 w-full h-full z-0 hidden md:block">
                    <video id="heroVideo1" class="w-full h-full object-cover" autoplay muted playsinline preload="auto">
                        <source src="./video-output-E4E7476A-A746-4397-8515-58E3B7A0A0AA.mp4" type="video/mp4; codecs=avc1.42E01E,mp4a.40.2">
                    </video>
                    <video id="heroVideo2" class="w-full h-full object-cover absolute top-0 left-0" muted playsinline preload="auto" style="opacity: 0;">
                        <source src="./fountain.mp4" type="video/mp4; codecs=avc1.42E01E,mp4a.40.2">
                    </video>
                </div>
                <div class="hero-overlay absolute inset-0 w-full h-full z-10"></div>
                <div class="container mx-auto px-4 md:px-6 relative z-20 flex flex-col items-center justify-center min-h-[40vh]">
                    <div class="flex flex-col items-center space-y-8 text-center max-w-4xl w-full">
                        <h1 class="text-4xl md:text-5xl lg:text-6xl font-bold tracking-tighter text-white">
                            Building Communities in a Neighbourhood Near You
                        </h1>
                        <p class="text-lg md:text-xl text-gray-100 max-w-[700px]">
                            NBRS is revolutionizing urban living with small midrise and multiplex projects that foster connection and community.
                        </p>
                        <a href="#partner" class="inline-flex items-center justify-center px-8 py-3 rounded-lg bg-[#FF6B6B] text-white hover:bg-[#FF8787] transition-colors duration-300">
                            Become a Partner
                        </a>
                    </div>
                </div>
            </section>

        <!-- Add this after the Hero Section and before the About Section -->

                    <!-- Cityscape Section -->
                    <section class="cityscape-section w-full relative overflow-hidden">
                        <svg id="cityscape" class="w-full h-32 md:h-48" viewBox="150 0 500 200" preserveAspectRatio="xMidYMax meet">
                            <!-- Clouds with circular edges -->
                            <path class="cloud cloud1" 
                                  d="M50,50 
                                     C60,40 75,35 90,40
                                     C100,30 120,30 130,40
                                     C140,30 160,30 170,40
                                     C180,35 195,40 200,50
                                     C200,65 170,70 150,65
                                     C140,70 110,70 100,65
                                     C80,70 60,65 50,50
                                     Z" />
                                     
                            <path class="cloud cloud2" 
                                  d="M250,30
                                     C260,20 275,15 290,20
                                     C300,10 320,10 330,20
                                     C340,15 355,20 360,30
                                     C360,45 330,50 310,45
                                     C290,50 270,45 250,30
                                     Z" />
                                     
                            <path class="cloud cloud3" 
                                  d="M450,70 
                                     C465,55 490,50 510,60
                                     C525,45 555,45 570,60
                                     C585,50 610,55 620,70
                                     C620,90 580,95 550,90
                                     C520,95 480,90 450,70
                                     Z" />
                            
                            <!-- Smaller birds -->
                            <path class="bird bird1" d="M20,40 c5-5,10-5,15,0 c5-5,10-5,15,0" />
                            <path class="bird bird2" d="M300,60 c4-4,8-4,12,0 c4-4,8-4,12,0" />
                            <path class="bird bird3" d="M500,30 c6-6,12-6,18,0 c6-6,12-6,18,0" />
                            
                            <!-- Buildings with updated colors -->
                            <path class="building" d="M0,200 v-65 h30 v13 h20 v-26 h15 v78 z" fill="#f5f5f5"/>
                            <path class="building" d="M65,200 v-52 h25 v-13 h15 v-10 h15 v75 z" fill="#e8e8e8"/>
                            <path class="building" d="M120,200 v-78 h30 v20 h20 v58 z" fill="#f0f0f0"/>
                            <path class="building" d="M170,200 v-46 h40 v46 z" fill="#f5f5f5"/>
                            <path class="building" d="M210,200 v-85 h30 v13 h20 v72 z" fill="#e8e8e8"/>
                            <path class="building" d="M260,200 v-59 h35 v59 z" fill="#f0f0f0"/>
                            <path class="building" d="M295,200 v-72 h25 v20 h30 v52 z" fill="#f5f5f5"/>
                            <path class="building" d="M350,200 v-52 h40 v52 z" fill="#e8e8e8"/>
                            <path class="building" d="M390,200 v-65 h30 v13 h15 v52 z" fill="#f0f0f0"/>
                            <path class="building" d="M435,200 v-55 h35 v55 z" fill="#f5f5f5"/>
                            <path class="building" d="M470,200 v-78 h40 v78 z" fill="#e8e8e8"/>
                            <path class="building" d="M510,200 v-59 h30 v13 h20 v46 z" fill="#f0f0f0"/>
                            <path class="building" d="M560,200 v-91 h35 v20 h20 v71 z" fill="#f5f5f5"/>
                            <path class="building" d="M615,200 v-62 h40 v13 h15 v49 z" fill="#e8e8e8"/>
                            <path class="building" d="M670,200 v-81 h30 v16 h25 v65 z" fill="#f0f0f0"/>
                            <path class="building" d="M725,200 v-52 h45 v52 z" fill="#f5f5f5"/>
                            <path class="building" d="M770,200 v-72 h35 v13 h20 v59 z" fill="#e8e8e8"/>
                            <path class="building" d="M825,200 v-85 h40 v20 h15 v65 z" fill="#f0f0f0"/>
                        </svg>
                    </section>

            <!-- About Section -->
            <section id="about" class="w-full py-20 md:py-32 relative overflow-hidden bg-[#4fa64f]">
                <!-- Background Video (hidden on mobile) -->
                <video id="aboutBgVideo" class="absolute inset-0 w-full h-full object-cover z-0 hidden md:block" style="pointer-events: none;" muted loop playsinline preload="none"></video>
                <div class="container mx-auto px-4 md:px-6 relative z-20">
                    <h2 class="text-3xl md:text-4xl font-bold text-center text-white mb-16">About NBRS</h2>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-6xl mx-auto">
                        <div v-for="card in aboutCards" :key="card.title" 
                             class="bg-white rounded-xl shadow-lg p-8 transform hover:scale-105 transition-transform duration-300">
                            <div class="w-16 h-16 rounded-full bg-[#4fa64f]/10 flex items-center justify-center mb-6 mx-auto">
                                <i :class="card.icon" class="h-8 w-8 text-[#4fa64f]"></i>
                            </div>
                            <h3 class="text-xl font-bold text-[#4fa64f] mb-4 text-center">{{ card.title }}</h3>
                            <p class="text-gray-600 text-center">{{ card.content }}</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Partner Section -->
            <section id="partner" class="w-full py-20 md:py-32 bg-white">
                <div class="container mx-auto px-4 md:px-6">
                    <div class="grid md:grid-cols-2 gap-12 items-center max-w-6xl mx-auto">
                        <div class="space-y-6">
                            <h2 class="text-3xl md:text-4xl font-bold text-[#4fa64f]">
                                Become a Neighborhood Partner
                            </h2>
                            <p class="text-gray-600 text-lg">
                                Are you a landowner looking to develop your property? Partner with NBRS and let us transform your land into thriving, sustainable communities.
                            </p>
                            <ul class="space-y-4">
                                <li v-for="benefit in benefits" :key="benefit" 
                                    class="flex items-center text-gray-600">
                                    <i class="lucide-check text-[#4fa64f] mr-3"></i>
                                    {{ benefit }}
                                </li>
                            </ul>
                        </div>
                        <div class="bg-[#4fa64f] rounded-xl p-8 text-white shadow-xl">
                            <div class="flex items-center mb-6">
                                <i class="lucide-handshake h-10 w-10 mr-4"></i>
                                <h3 class="text-2xl font-bold">Start Your Partnership Journey</h3>
                            </div>
                            <form @submit.prevent="submitForm" class="space-y-4" action="confirmation.html">
                                <!-- Name row -->
                                <div class="grid grid-cols-2 gap-4">
                                    <input 
                                        type="text" 
                                        placeholder="First Name" 
                                        class="w-full p-3 rounded-lg bg-white/10 border-0 text-white placeholder-gray-300">
                                    <input 
                                        type="text" 
                                        placeholder="Last Name" 
                                        class="w-full p-3 rounded-lg bg-white/10 border-0 text-white placeholder-gray-300">
                                </div>
                                <!-- Other fields -->
                                <input 
                                    type="email" 
                                    placeholder="Your Email" 
                                    class="w-full p-3 rounded-lg bg-white/10 border-0 text-white placeholder-gray-300">
                                <input 
                                    type="tel" 
                                    placeholder="Phone Number" 
                                    class="w-full p-3 rounded-lg bg-white/10 border-0 text-white placeholder-gray-300">
                                <input 
                                    type="text" 
                                    placeholder="Property Address" 
                                    class="w-full p-3 rounded-lg bg-white/10 border-0 text-white placeholder-gray-300">
                                <input 
                                    type="text" 
                                    placeholder="City" 
                                    class="w-full p-3 rounded-lg bg-white/10 border-0 text-white placeholder-gray-300">
                                <button type="submit" 
                                        class="w-full py-3 px-6 rounded-lg bg-[#FF6B6B] hover:bg-[#FF8787] transition-colors duration-300 flex items-center justify-center">
                                    Submit
                                    <i class="lucide-arrow-right ml-2"></i>
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="bg-[#4fa64f] border-t border-[#3d8b3d] py-6">
            <div class="container mx-auto px-4 md:px-6">
                <div class="flex flex-col sm:flex-row items-center justify-between">
                    <p class="text-sm text-white mb-4 sm:mb-0">Â© 2024 NBRS. All rights reserved.</p>
                    <div class="flex flex-wrap justify-center gap-6">
                        <a v-for="link in footerLinks" :key="link.text"
                           class="flex items-center text-sm text-white hover:underline">
                            <i :class="link.icon" class="h-4 w-4 mr-2"></i>
                            {{ link.text }}
                        </a>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <script>
        const { createApp } = Vue

        createApp({
            data() {
                return {
                    menuOpen: false,
                    aboutCards: [
                        {
                            icon: 'lucide-users',
                            title: 'Community Focused',
                            content: 'We design spaces that bring people together, fostering a sense of belonging in every project.'
                        },
                        {
                            icon: 'lucide-building-2',
                            title: 'Urban Innovation',
                            content: 'Our small midrise and multiplex projects are tailored to fit seamlessly into Toronto\'s urban fabric.'
                        },
                        {
                            icon: 'lucide-tree',
                            title: 'Sustainable Living',
                            content: 'We prioritize eco-friendly designs and materials to create sustainable, future-proof communities.'
                        }
                    ],
                    benefits: [
                        'Expert property development',
                        'Sustainable design practices',
                        'Community-focused approach'
                    ],
                    formFields: [
                        { name: 'firstname', type: 'text', placeholder: 'First Name' },
                        { name: 'lastname', type: 'text', placeholder: 'Last Name' },
                        { name: 'email', type: 'email', placeholder: 'Your Email' },
                        { name: 'phone', type: 'tel', placeholder: 'Phone Number' },
                        { name: 'streetaddress', type: 'text', placeholder: 'Property Address' },
                        { name: 'city', type: 'text', placeholder: 'City' }
                    ],
                    footerLinks: [
                        { icon: 'lucide-mail', text: 'hello@nbrs.ca' },
                        { icon: 'lucide-map-pin', text: 'Toronto, ON' }
                    ]
                }
            },
            methods: {
                submitForm() {
                    // Redirect to confirmation page
                    window.location.href = 'confirmation.html';
                }
            }
        }).mount('#app')
    </script>
    <script>
        window.addEventListener('DOMContentLoaded', () => {
            // First timeline - intro sequence
            const introTimeline = gsap.timeline();
            
            // Calculate the diagonal of the screen for the circle expansion
            const w = window.innerWidth;
            const h = window.innerHeight;
            const diagonal = Math.sqrt(w * w + h * h);
            
            // Add slide-content class to main elements we want to animate
            document.querySelector('header').classList.add('slide-content');
            document.querySelectorAll('main section').forEach(section => {
                section.classList.add('slide-content');
            });
            document.querySelector('footer').classList.add('slide-content');
            
            // Make app visible but with elements hidden
            document.querySelector('#app').style.visibility = 'visible';
            
            // Initial animation sequence
            introTimeline
                .from('.letter', {
                    opacity: 0,
                    scale: 0,
                    y: 100,
                    rotationX: 180,
                    stagger: 0.5,
                    duration: 1,
                    ease: "back.out(1.7)"
                })
                .to('.letter', {
                    opacity: 1,
                    scale: 1.2,
                    stagger: 0.2,
                    duration: 0.5,
                    ease: "power2.inOut"
                })
                .to('.letter', {
                    scale: 1,
                    stagger: 0.2,
                    duration: 0.5
                })
                .to({}, { duration: 0.5 })
                .to('.white-overlay', {
                    width: diagonal * 2,
                    height: diagonal * 2,
                    duration: 1.5,
                    ease: "power2.inOut"
                })
                .to('.intro-text', {
                    opacity: 0,
                    duration: 0.5,
                    ease: "power2.inOut"
                }, "-=1")
                .set('.intro-overlay', {
                    display: 'none'
                })
                .to('.slide-content', {
                    opacity: 1,
                    y: 0,
                    duration: 2,
                    stagger: 0.4,
                    ease: "power4.out"
                })

            // Update the timing of background animations
            introTimeline
                .add(() => {
                    // Buildings animation
                    gsap.to('.building', {
                        opacity: 1,
                        scaleY: 1,
                        duration: 1.5,
                        stagger: {
                            each: 0.1,
                            from: "random"
                        },
                        ease: "power2.out"
                    });
                })
                .add(() => {
                    // Clouds and birds appear after buildings
                    gsap.to(['.cloud', '.bird'], {
                        opacity: 1,
                        duration: 1,
                        stagger: 0.2
                    });
                    
                    // Start the continuous animations
                    gsap.to('.cloud1', {
                        x: window.innerWidth > 768 ? 300 : 150,
                        duration: window.innerWidth > 768 ? 30 : 20,
                        repeat: -1,
                        ease: 'none',
                        yoyo: true
                    });
                    
                    gsap.to('.cloud2', {
                        x: window.innerWidth > 768 ? 400 : 200,
                        duration: window.innerWidth > 768 ? 40 : 25,
                        repeat: -1,
                        ease: 'none',
                        yoyo: true
                    });
                    
                    gsap.to('.cloud3', {
                        x: window.innerWidth > 768 ? 350 : 175,
                        duration: window.innerWidth > 768 ? 35 : 22,
                        repeat: -1,
                        ease: 'none',
                        yoyo: true
                    });
                    
                    gsap.to('.bird1', {
                        x: 400,
                        y: -15,
                        duration: 20,
                        repeat: -1,
                        ease: 'none'
                    });
                    
                    gsap.to('.bird2', {
                        x: 350,
                        y: -10,
                        duration: 25,
                        repeat: -1,
                        ease: 'none'
                    });
                    
                    gsap.to('.bird3', {
                        x: 300,
                        y: -12,
                        duration: 22,
                        repeat: -1,
                        ease: 'none'
                    });
                }, "+=0.5"); // Delay after buildings finish

            // Video switching logic
            const videos = [
                {
                    url: './video-output-E4E7476A-A746-4397-8515-58E3B7A0A0AA.mp4',
                    type: 'video/mp4; codecs=avc1.42E01E,mp4a.40.2',
                    duration: 11
                },
                {
                    url: './fountain.mp4',
                    type: 'video/mp4; codecs=avc1.42E01E,mp4a.40.2',
                    duration: 20
                },
                {
                    url: './tasteofitaly.mp4',
                    type: 'video/mp4; codecs=avc1.42E01E,mp4a.40.2',
                    duration: 15
                },
                {
                    url: './night.mp4',
                    type: 'video/mp4; codecs=avc1.42E01E,mp4a.40.2',
                    duration: 9
                }
            ];
            let currentVideoIndex = 0;
            let loadedVideos = new Set();
            let isSwitching = false;
            let retryCount = 0;
            const MAX_RETRIES = 3;

            // Initialize video elements
            const video1 = document.getElementById('heroVideo1');
            const video2 = document.getElementById('heroVideo2');
            let activeVideo = video1;
            let nextVideo = video2;

            // Preload all videos
            function preloadVideo(videoInfo) {
                return new Promise((resolve, reject) => {
                    const video = document.createElement('video');
                    video.preload = 'auto';
                    
                    // Create source element
                    const source = document.createElement('source');
                    source.src = videoInfo.url;
                    source.type = videoInfo.type;
                    video.appendChild(source);
                    
                    // Add error handling for source
                    source.addEventListener('error', (e) => {
                        console.error('Error loading video source:', videoInfo.url, e);
                        // Try without codec specification
                        if (source.type.includes('codecs')) {
                            source.type = 'video/mp4';
                            video.load();
                        } else {
                            reject(e);
                        }
                    }, { once: true });
                    
                    video.addEventListener('loadeddata', () => {
                        loadedVideos.add(videoInfo.url);
                        console.log('Successfully loaded video:', videoInfo.url);
                        resolve();
                    }, { once: true });
                    
                    video.addEventListener('error', (e) => {
                        console.error('Error preloading video:', videoInfo.url, e);
                        // Try without codec specification
                        if (source.type.includes('codecs')) {
                            source.type = 'video/mp4';
                            video.load();
                        } else {
                            reject(e);
                        }
                    }, { once: true });
                    
                    video.load();
                });
            }

            // Function to switch videos with fade transition
            async function switchVideos() {
                if (isSwitching) return;
                isSwitching = true;

                try {
                    // Update next video source
                    currentVideoIndex = (currentVideoIndex + 1) % videos.length;
                    const nextVideoInfo = videos[currentVideoIndex];
                    const nextSource = nextVideo.querySelector('source');
                    
                    // Update source
                    nextSource.src = nextVideoInfo.url;
                    nextSource.type = nextVideoInfo.type;
                    
                    console.log('Switching to video:', nextVideoInfo.url);
                    
                    // Ensure next video is loaded before switching
                    if (!loadedVideos.has(nextVideoInfo.url)) {
                        await preloadVideo(nextVideoInfo);
                    }
                    
                    nextVideo.load();
                    
                    // Wait for next video to be ready
                    await new Promise((resolve) => {
                        const canPlayHandler = () => {
                            nextVideo.removeEventListener('canplaythrough', canPlayHandler);
                            resolve();
                        };
                        nextVideo.addEventListener('canplaythrough', canPlayHandler);
                    });

                    // Fade transition
                    gsap.to(activeVideo, {
                        opacity: 0,
                        duration: 0.5,
                        ease: 'power2.inOut',
                        onComplete: () => {
                            activeVideo.pause();
                            [activeVideo, nextVideo] = [nextVideo, activeVideo];
                            isSwitching = false;
                            retryCount = 0;
                        }
                    });

                    gsap.to(nextVideo, {
                        opacity: 1,
                        duration: 0.5,
                        ease: 'power2.inOut'
                    });

                    await nextVideo.play();
                } catch (error) {
                    console.error('Error during video switch:', error);
                    isSwitching = false;
                    
                    if (retryCount < MAX_RETRIES) {
                        retryCount++;
                        console.log(`Retrying video switch (attempt ${retryCount}/${MAX_RETRIES})`);
                        setTimeout(switchVideos, 1000 * retryCount);
                    } else {
                        console.error('Max retries reached, falling back to next video');
                        retryCount = 0;
                        currentVideoIndex = (currentVideoIndex + 1) % videos.length;
                        setTimeout(switchVideos, 1000);
                    }
                }
            }

            // Set up video switching
            async function setupVideoSwitching() {
                try {
                    // Preload all videos in parallel
                    await Promise.all(videos.map(video => preloadVideo(video)));
                    console.log('All videos preloaded successfully');

                    // Handle first video element
                    video1.addEventListener('timeupdate', function() {
                        if (video1.currentTime >= videos[currentVideoIndex].duration - 0.5) {
                            switchVideos();
                        }
                    });

                    // Handle second video element
                    video2.addEventListener('timeupdate', function() {
                        if (video2.currentTime >= videos[currentVideoIndex].duration - 0.5) {
                            switchVideos();
                        }
                    });

                    // Add ended event handlers as backup
                    video1.addEventListener('ended', switchVideos);
                    video2.addEventListener('ended', switchVideos);

                    // Add error handlers with retry logic
                    video1.addEventListener('error', function(e) {
                        console.error('Video 1 error:', e);
                        if (retryCount < MAX_RETRIES) {
                            retryCount++;
                            setTimeout(() => {
                                video1.load();
                                video1.play();
                            }, 1000 * retryCount);
                        } else {
                            switchVideos();
                        }
                    });

                    video2.addEventListener('error', function(e) {
                        console.error('Video 2 error:', e);
                        if (retryCount < MAX_RETRIES) {
                            retryCount++;
                            setTimeout(() => {
                                video2.load();
                                video2.play();
                            }, 1000 * retryCount);
                        } else {
                            switchVideos();
                        }
                    });

                } catch (error) {
                    console.error('Error setting up video switching:', error);
                }
            }

            // Initialize video switching
            setupVideoSwitching();

            // Ensure first video plays with retry logic
            async function startFirstVideo() {
                try {
                    await video1.play();
                } catch (error) {
                    console.error("Initial video play failed:", error);
                    if (retryCount < MAX_RETRIES) {
                        retryCount++;
                        setTimeout(startFirstVideo, 1000 * retryCount);
                    }
                }
            }

            startFirstVideo();
        });

        // Set initial state
        gsap.set(['.cloud', '.bird'], { opacity: 0 });

        // Lazy load About section background video
        document.addEventListener('DOMContentLoaded', function() {
            const aboutSection = document.getElementById('about');
            const aboutBgVideo = document.getElementById('aboutBgVideo');
            let loaded = false;
            if (aboutSection && aboutBgVideo) {
                const observer = new window.IntersectionObserver((entries, obs) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting && !loaded) {
                            aboutBgVideo.src = './tasteofitaly.mp4';
                            aboutBgVideo.load();
                            aboutBgVideo.play();
                            loaded = true;
                            obs.disconnect();
                        }
                    });
                }, { rootMargin: '200px' });
                observer.observe(aboutSection);
            }
        });
    </script>
</body>
</html>